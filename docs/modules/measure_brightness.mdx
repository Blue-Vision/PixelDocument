# Measure Brightness
Là công cụ sử dụng để đo độ sáng của hình ảnh dạng gray (hình ảnh 1 kênh màu). Dựa trên kết quả đo độ sáng của hình ảnh có thể cài đặt giới hạn xác định hình ảnh đạt tiêu chuẩn hay không đạt tiêu chuẩn.

**Ứng dụng phổ biến của Measure Brightness:**
- :white_check_mark: Ứng dụng cho bài toán cần kiểm tra có độ sáng của vật thể khác biệt so với vật thể còn lại.

[Tham khảo công cụ đo màu sắc - Measure Color](/docs/modules/Measure_Color) 

[Tham khảo công cụ đếm pixel - Count Pixel Intensity](/docs/modules/Count_Pixel_Intensity)

## Video hướng dẫn
<VideoPlayer url='/videos/measure_brightness/measure_brightness.mp4' youtubeUrl='https://www.youtube.com/watch?v=OelzLRVyL5A' />

Các công cụ hỗ trợ được sử dụng trong video:
-   [Nguồn ảnh - Imagesource](/docs/modules/Imagesource)
-   [Định vị - Shape Matching](/docs/modules/Shape_Matching)

## Biểu đồ histogram

Biểu đồ histogram biểu thị độ phủ sáng của hình ảnh, giúp hiểu rõ hơn về phân bổ độ sáng của hình ảnh. Biểu đồ biểu diễn tổng số lượng những pixel (điểm ảnh) có độ sáng (giá trị màu) giống nhau.
-   Trục **x**: giá trị cường độ pixel (0 - 255 với ảnh 8-bit).
-   Trục **y**: số lượng pixel có giá trị tương ứng.
<Image src="/images/measure_brightness/1.PNG" />

Histogram giúp ta hiểu đặc điểm sáng/tối của ảnh:
-   Histogram lệch trái → ảnh tối.
-   Histogram lệch phải → ảnh sáng.
-   Histogram trải rộng đều → ảnh có độ tương phản cao.

Với đồ thị trêm nhận xét thấy đồ thị phân bố tập trung ở 2 vùng, vùng thứ nhất là **x** từ 25-75 tương ứng với những điểm ảnh có giá trị từ 25-75, và vùng thứ hai **x** từ 210-225 tương ứng với những điểm ảnh từ 210-225.
Ảnh thiên về tối nhiều hơn (màu nền tối), vùng sáng có ít điểm ảnh hơn (hình cánh hoa trong ảnh).

## Biểu đồ cumulative histogram

Cumulative Histogram (biểu đồ tích lũy) là một dạng biểu đồ thể hiện tổng số pixel có giá trị cường độ sáng nhỏ hơn hoặc bằng một mức nhất định trong ảnh. Nó được tính dựa trên Histogram thường nhưng có dạng tích lũy.
-   Trục **x**: giá trị cường độ pixel (0 - 255 với ảnh 8-bit).
-   Trục **y**: phần trăm tích lũy tính tới giá trị cường độ pixel (0-100%).

Để xem biểu đồ cumulative histogram người dùng lựa chọn loại biểu đồ trong mục biểu đồ.
<Image src="/images/measure_brightness/3.PNG" />
-   **Ngưỡng dưới**: ngưỡng phần trăm tích lũy của pixel, đường đỏ tính từ dưới lên (giá trị từ 0-100).
-   **Ngưỡng trên**: ngưỡng phần trăm tích lũy của pixel, đường đỏ tính từ trên xuống (giá trị từ 0-100).

## Thông số đo
Công cụ đo trả về các thông số:
-   **Trung bình**: giá trị trung bình của độ sáng của hình ảnh.
-   **Độ lệch tiêu chuẩn**: độ lệch chuẩn của độ sáng của hình ảnh.
-   **Tối thiểu**: giá trị độ sáng tối nhất của hình ảnh.
-   **Tối đa**: giá trị độ sáng sáng nhất của hình ảnh.
-   **Cường độ ngưỡng dưới**: cường độ pixel tại cài đặt **Ngưỡng dưới** của biểu đồ cumulative histogram.
-   **Cường độ ngưỡng trên**: cường độ pixel tại cài đặt **Ngưỡng trên** của biểu đồ cumulative histogram.

## Cài đặt giới thạn
Các giới hạn cài đặt dựa trên thông số đo:
-   **Trung bình**: cài đặt giới hạn cho giá trị **trung bình**.
-   **Độ lệch tiêu chuẩn**: cài đặt giới hạn cho giá trị **độ lệch tiêu chuẩn**.
-   **Tối thiểu**: cài đặt giới hạn cho giá trị **tối thiểu**.
-   **Tối đa**: cài đặt giới hạn cho giá trị **tối đa**.
-   **Cường độ ngưỡng dưới**: cài đặt giới hạn cho giá trị **Cường độ ngưỡng dưới**.
-   **Cường độ ngưỡng trên**: cài đặt giới hạn cho giá trị **Cường độ ngưỡng trên**.

:::tip

:white_check_mark: Như trong video hướng dẫn, người dùng nên chạy nhiều ảnh khác nhau để thấy sự thay đổi của các kết quả đo. **Độ lệch tiêu chuẩn** của sản phẩm có nắp chai có kết quả đo được trong khoảng từ 64-88, 
sản phẩm không có nắp chai kết quả đo được là 103. Như vậy ta có thể cài đặt giới hạn cho **Độ lệch tiêu chuẩn** ví dụ từ 60-95 để phân biệt sản phẩm có nắp chai và không có nắp chai. 
Con số 60-95 này được chọn sao cho bao phủ dải đo của sản phẩm có nắp chai, nên đặt ngưỡng mở rộng ra để tránh trường hợp lỗi ảo. Người dùng nên
thử nghiệm với nhiều ảnh khác nhau để chọn ngưỡng phù hợp nhất.

:white_check_mark: Có thể sử dụng bất cứ thông số nào miễn là có sự khác biệt giữa thông số đó ở 2 loại sản phẩm.

:::